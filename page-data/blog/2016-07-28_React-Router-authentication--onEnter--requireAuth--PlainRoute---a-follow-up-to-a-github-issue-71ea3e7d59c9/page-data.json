{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2016-07-28_React-Router-authentication--onEnter--requireAuth--PlainRoute---a-follow-up-to-a-github-issue-71ea3e7d59c9/","webpackCompilationHash":"f146ed55f93bb0a77a00","result":{"data":{"site":{"siteMetadata":{"title":"Peter Piekarczyk","author":"@peterpme"}},"markdownRemark":{"id":"aaa5970a-cba1-5fa6-ba0c-89c774da4cf1","excerpt":"I was looking through the issues of a popular boilerplate today and there was a question about how folks would handle…","html":"<p>I was looking through the <a href=\"https://github.com/davezuko/react-redux-starter-kit/issues/906\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">issues of a popular boilerplate</a> today and there was a question about how folks would handle authentication with this new style of creating routes (<a href=\"https://github.com/reactjs/react-router/blob/master/docs/API.md#plainroute\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PlainRoute</a>).</p>\n<p><strong>Here’s what you need to know:</strong></p>\n<ul>\n<li><code class=\"language-text\">requireAuth</code> is a <a href=\"https://github.com/reactjs/react-router/blob/master/docs/API.md#onenternextstate-replace-callback\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Router</a> function. It takes 3 arguments: nextState, replace, callback</li>\n<li><strong>replace</strong> is all we’re after, but you have the ability to do more if you choose to</li>\n<li>within <code class=\"language-text\">requireAuth</code>, invoke whatever technique you’re using to identify a user or a token</li>\n<li>If a token exists, carry on</li>\n<li>If a token does not exist, replace history with an unauthenticated route</li>\n<li>If you decide to use a callback, the transition will be blocked until <code class=\"language-text\">callback</code> is called (in the docs)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">requireAuth</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">nextState<span class=\"token punctuation\">,</span> replace<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@TOKEN'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>token<span class=\"token punctuation\">)</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createRoutes</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  childRoutes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\n    <span class=\"token comment\">// Authenticated</span>\n    <span class=\"token punctuation\">{</span>\n      component<span class=\"token punctuation\">:</span> CoreLayout<span class=\"token punctuation\">,</span>\n <span class=\"token operator\">**</span>onEnter<span class=\"token punctuation\">:</span> requireAuth<span class=\"token punctuation\">,</span> <span class=\"token comment\">// add this**</span>\n      indexRoute<span class=\"token punctuation\">:</span> Dashboard<span class=\"token punctuation\">,</span>\n      childRoutes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">ProfileRoute</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        BillingRoute\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">// Not-authenticated</span>\n    <span class=\"token punctuation\">{</span>\n      component<span class=\"token punctuation\">:</span> ModalLayout<span class=\"token punctuation\">,</span>\n      childRoutes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        LoginRoute\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">// Other Not-authenticated routes</span>\n    HelpRoute<span class=\"token punctuation\">,</span>\n    ContactRoute\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>If you have any issues, <a href=\"http://twitter.com/peterpme\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">hit me up</a>!</p>","timeToRead":1,"fields":{"slug":"blog/2016-07-28_React-Router-authentication--onEnter--requireAuth--PlainRoute---a-follow-up-to-a-github-issue-71ea3e7d59c9/"},"frontmatter":{"title":"React Router Authentication","date":"July 28, 2016","description":"An easy way to route based on a logged in user"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"blog/2016-07-28_React-Router-authentication--onEnter--requireAuth--PlainRoute---a-follow-up-to-a-github-issue-71ea3e7d59c9/","previous":{"fields":{"slug":"blog/2016-07-07_Quickly-Preview-iTerm2-Themes-Without-Having-to-Import-Them-First-3bb608b4974e/"},"frontmatter":{"title":"Quickly Preview iTerm2 Themes Without Having to Import Them First"}},"next":{"fields":{"slug":"blog/2016-10-29_Save-20px-by-Going-Frameless-and-Getting-Rid-of-Atom-s-Title-Bar-f66346f42325/"},"frontmatter":{"title":"Save 20px by Going Frameless and Getting Rid of Atom’s Title Bar"}}}}}